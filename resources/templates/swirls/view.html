{% extends "base.html" %}
{% block content %}

<h1>You should consume {{swirl.title}}</h1>

{% if can-edit %}

<p class="swirl-admin-panel">
    <a href="{{ swirl.id|swirlediturl }}">[edit this page]</a>
</p>

{% endif %}

{% include "swirls/affiliate-links.html" %}

<article>
    {{swirl.review|safe}}
</article>

<div class="responses">

    {% if can-respond %}

    <h2>Seen it? What did you think?</h2>

    <form method="POST" action="/swirls/{{swirl.id}}/respond">
        {% csrf-field %}
        <input type="hidden" name="swirl-id" value="{{swirl.id}}">

        <input type="submit" name="responseButton" value="Loved it">
        <input type="submit" name="responseButton" value="Hated it">
        <input type="submit" name="responseButton" value="Meh">

        or
        <input type="text" name="response-summary" maxlength="{{constraints.swirl_responses.summary.max-length}}"
               value="{{response-summary}}"
               placeholder="Enter a short response">
        <input type="submit" name="responseButton" value="Submit">

        <p>Don't want to see it?
            <input type="submit" name="responseButton" value="Not interested">
        </p>


    </form>

    {% endif %}


    <div class="responses">
        {% for resp in responses %}
        {{ resp.email_md5|gravatar-img:40 }}
        <span class="username"><a href="/swirls/by/{{resp.username | urlescape}}">{{resp.username}}</a> said</span>
        <span class="response">{{resp.summary}}</span>
        {% endfor %}
    </div>

</div>


<h2>Comments</h2>

<div class="comments">
    {% for comment in comments %}

    <div class="comment">
        {{ comment.email_md5|gravatar-img:40 }}

        <div class="comment-body">
            <a class="user-link" href="/swirls/by/{{ comment.username|urlescape }}">{{comment.username}}</a>
            {{ comment.html_content|linebreaks|safe }}

            <time datetime="{{comment.date_responded}}">{{comment.date_responded|date:longDateTime}}</time>
        </div>
    </div>

    {% endfor %}
</div>


{% if user %}


<form method="POST" action="/swirls/{{swirl.id}}/comment" class="comment">
    {% csrf-field %}

    <input type="hidden" name="swirl-id" value="{{swirl.id}}">

    {{ user.email_md5|gravatar-img:40 }}
    <div class="comment-body">
        <a class="user-link" href="/swirls/by/{{ user.username|urlescape }}">{{user.username}}</a>
        <textarea name="comment" required placeholder="Add your comment">{{current-comment}}</textarea>
        <input type="submit" value="Add comment">
    </div>

</form>


{% else %}

<p>Sign in to have your say.</p>

{% include "auth/logister.html" %}

{% endif %}

{% include "swirls/affiliate-links.html" %}

{% endblock %}
